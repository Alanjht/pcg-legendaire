<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Énigme 3 - PCG</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 40px;
      background-color: #f4f4f9;
      color: #333;
    }
    h1, h2 {
      color: #2c3e50;
    }
    input[type="text"], select {
      padding: 8px;
      margin: 5px 0 15px 0;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      padding: 10px 20px;
      background-color: #27ae60;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #219150;
    }
    #successMessage {
      color: green;
      font-weight: bold;
      display: none;
    }
    #errorMessage {
      color: red;
      font-weight: bold;
      display: none;
    }
    #nextEnigmaButton {
      display: none;
      margin-top: 20px;
      background-color: #2980b9;
    }
    #nextEnigmaButton:hover {
      background-color: #2471a3;
    }
  </style>
</head>
<body>

  <h1>Énigme 3 - PCG</h1>

  <p>
    Félicitations, tu as franchi une nouvelle étape ! Mais le chemin vers le légendaire PCG est encore semé d'embûches.
    Résous attentivement cette énigme en deux parties.
  </p>

  <h2>Partie 1 : Question + Rébus</h2>
  <p><strong>La réponse se situe dans la salle du petit déjeuner. Attention à ce qui saute aux yeux !</strong></p>
  <input type="text" id="questionPetitDej" placeholder="Votre réponse ici (MAJUSCULES, ANGLAIS)" />

  <p>Résous le rébus ci-dessous (réponse attendue en anglais et en majuscules) :</p>
  <img src="gorge.png" alt="Rébus gorge" style="max-width: 100%; height: auto;" />
  <input type="text" id="rebus" placeholder="Votre réponse ici (MAJUSCULES, ANGLAIS)" />

  <h2>Partie 2 : Texte à trous</h2>
  <p>Complète le texte avec les bonnes réponses :</p>

  <p>Le plan comptable est un outil de 
    <select id="q2">
      <option value="">--Choix--</option>
      <option value="référence">référence</option>
      <option value="gestion">gestion</option>
      <option value="contrôle">contrôle</option>
    </select>.
  </p>

  <p>Les amortissements concernent la perte de 
    <select id="q3">
      <option value="">--Choix--</option>
      <option value="durée">durée</option>
      <option value="valeur">valeur</option>
      <option value="quantité">quantité</option>
    </select> des biens.
  </p>

  <p>Les charges sont des dépenses 
    <select id="q4">
      <option value="">--Choix--</option>
      <option value="d'exploitation">d'exploitation</option>
      <option value="financières">financières</option>
      <option value="exceptionnelles">exceptionnelles</option>
    </select> pour faire fonctionner l'association.
  </p>

  <p>Les produits correspondent aux 
    <select id="q5">
      <option value="">--Choix--</option>
      <option value="dettes">dettes</option>
      <option value="dépenses">dépenses</option>
      <option value="ressources">ressources</option>
    </select> de l'association.
  </p>

  <p>La TVA normale est actuellement de 
    <select id="q6">
      <option value="">--Choix--</option>
      <option value="20%">20%</option>
      <option value="5,5%">5,5%</option>
      <option value="10%">10%</option>
    </select> en France.
  </p>

  <p>La tenue de la comptabilité est 
    <select id="q7">
      <option value="">--Choix--</option>
      <option value="interdite">interdite</option>
      <option value="facultative">facultative</option>
      <option value="obligatoire">obligatoire</option>
    </select> pour une association qui reçoit des subventions publiques.
  </p>

  <p>Un bilan comptable est constitué de l'actif et du 
    <select id="q8">
      <option value="">--Choix--</option>
      <option value="passif">passif</option>
      <option value="produit">produit</option>
      <option value="résultat">résultat</option>
    </select>.
  </p>

  <p>La différence entre les produits et les charges constitue le 
    <select id="q9">
      <option value="">--Choix--</option>
      <option value="passif">passif</option>
      <option value="résultat">résultat</option>
      <option value="budget">budget</option>
    </select>.
  </p>

  <p>Une subvention est considérée comme un 
    <select id="q10">
      <option value="">--Choix--</option>
      <option value="passif">passif</option>
      <option value="charge">charge</option>
      <option value="produit">produit</option>
    </select> dans les comptes.
  </p>

  <button onclick="verifierEnigme()">Vérifier mes réponses</button>

  <p id="successMessage">Bravo ! Toutes les réponses sont correctes.</p>
  <p id="errorMessage">Dommage, certaines réponses sont incorrectes ou incomplètes. Réessaie !</p>

  <button id="nextEnigmaButton" onclick="verifierEtPasser()">Passer à l'énigme suivante</button>

  <script>
    function verifierEnigme() {
      // Partie 1
      const petitDej = document.getElementById('questionPetitDej').value.trim().toUpperCase();
      const reponsePetitDejOk = petitDej === "BITCOIN";

      const rebus = document.getElementById('rebus').value.trim().toUpperCase();
      const reponseCorrecteRebus = "TO HAVE A FROG IN ONE'S THROAT";
      const rebusSansApostrophe = rebus.replace(/'/g, "");
      const correctRebusSansApostrophe = reponseCorrecteRebus.replace(/'/g, "");
      const rebusOk = rebusSansApostrophe === correctRebusSansApostrophe;

      const partie1Ok = reponsePetitDejOk && rebusOk;

      // Partie 2
      const bonnesReponses = {
        q2: 'référence',
        q3: 'valeur',
        q4: "d'exploitation",
        q5: 'ressources',
        q6: '20%',
        q7: 'obligatoire',
        q8: 'passif',
        q9: 'résultat',
        q10: 'produit'
      };

      let partie2Ok = true;
      for (let question in bonnesReponses) {
        const reponse = document.getElementById(question).value;
        if (reponse !== bonnesReponses[question]) {
          partie2Ok = false;
          break;
        }
      }

      if (partie1Ok && partie2Ok) {
        document.getElementById('successMessage').style.display = 'block';
        document.getElementById('errorMessage').style.display = 'none';
        document.getElementById('nextEnigmaButton').style.display = 'inline-block'; // On affiche le bouton !
        localStorage.setItem('enigme3_reussie', 'true'); // On marque l'énigme 3 comme réussie
      } else {
        document.getElementById('errorMessage').style.display = 'block';
        document.getElementById('successMessage').style.display = 'none';
        document.getElementById('nextEnigmaButton').style.display = 'none'; // On cache le bouton si erreurs
      }
    }

    function verifierEtPasser() {
      // On vérifie si l'énigme 3 est réussie avant de passer à l'énigme 4
      if (localStorage.getItem('enigme3_reussie') === 'true') {
        location.href = 'enigme4.html'; // On passe à l'énigme 4
      } else {
        alert("Tu dois résoudre l'énigme 3 avant de passer à l'énigme 4.");
      }
    }
  </script>

</body>
</html>
