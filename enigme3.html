<script>
  function verifierEnigme() {
    // Vérification de la salle BECOD
    const salleBecod = document.getElementById('salleBecod').value.trim().toUpperCase();
    const salleBecodOk = salleBecod === "BITCOIN";

    // Vérification du rébus (en prenant en compte l'apostrophe)
    const reponseRebus2 = document.getElementById('rebus2').value.trim().toUpperCase();
    const correctRebus2 = "TO HAVE A FROG IN ONE'S THROAT";
    const reponseRebus2SansApostrophe = reponseRebus2.replace(/'/g, "");  // Retirer l'apostrophe de la réponse donnée
    const correctRebus2SansApostrophe = correctRebus2.replace(/'/g, ""); // Retirer l'apostrophe de la réponse correcte

    const rebusOk = reponseRebus2SansApostrophe === correctRebus2SansApostrophe;

    // Vérification du texte à trous
    const bonnesReponses = {
      q2: 'référence',
      q3: 'valeur',
      q4: "d'exploitation",
      q5: 'ressources',
      q6: '20%',
      q7: 'obligatoire',
      q8: 'passif',
      q9: 'résultat',
      q10: 'produit'
    };

    let texteOk = true;
    for (let question in bonnesReponses) {
      const reponse = document.getElementById(question).value;
      if (reponse !== bonnesReponses[question]) {
        texteOk = false;
        break;
      }
    }

    if (salleBecodOk && rebusOk && texteOk) {
      document.getElementById('successMessage').style.display = 'block';
      document.getElementById('errorMessage').style.display = 'none';
      document.getElementById('nextLink').style.display = 'inline-block';
      localStorage.setItem('enigme3_reussie', 'true');
    } else {
      document.getElementById('errorMessage').style.display = 'block';
      document.getElementById('successMessage').style.display = 'none';
      document.getElementById('nextLink').style.display = 'none';
    }
  }

  // Protection si l'énigme précédente n'a pas été résolue
  if (!localStorage.getItem('enigme2_reussie')) {
    window.location.href = 'index.html';
  }
</script>
